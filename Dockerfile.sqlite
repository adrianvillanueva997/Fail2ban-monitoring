FROM python:3.11-slim

WORKDIR /app

# Install uv package manager
RUN pip install --no-cache-dir uv

# Copy project files
COPY . .

# Install project dependencies with SQLite extras
RUN uv pip install -e ".[sqlite]"

# Set environment variables
ENV PYTHONUNBUFFERED=1
ENV DB_TYPE=sqlite
ENV DB_NAME=/app/data/fail2ban.db

# Create data directory
RUN mkdir -p /app/data

# Command to run when container starts
CMD ["python", "-m", "src.main"]